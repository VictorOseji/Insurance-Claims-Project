pip install mlflow

import mlflow

mlflow.set_tracking_url("")
mlflow.set_experiment("fnol_ultimate_claim_experiment")
mlflow.get_trackig_url()
models = {
    "rf_model": Random_forest_model,
    "linearReg_Model": Linear_Regression_Model,
    "GradientBoost_model": Gradient_Boost_Model,
    "Tuned_rf_model":Best_rf_model 
}


from sklearn.metrics import mean_squared_error, mean_absolute_error, r2_score

for model_name, model in models.items():
    with mlflow.start_run(run_name = model_name):

        # Log parameters (model hyperparameters)
        if hasattr(model, "get_params"):
            mlflow.log_param(model.get_param())

        model_pred_log = model.predict(X_test)
        preds = np.expml(model_pred_log)

        mae = mean_absolute_error(y_test, preds)
        mse = mean_squared_error(y_test, preds)
        r2 = r2_score(y_test, preds)

        mlflow.log_metrics({
            "MAE": mae,
            "MSE": mse,
            "R2": r2
        })

        mlflow.sklearn.log_model(model,model_name)

    print("All model logges successfully")